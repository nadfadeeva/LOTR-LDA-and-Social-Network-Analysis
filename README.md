**Учебный проект "Применение методов тематического моделирования и сетевого анализа для исследования структуры трилогии «Властелин колец» Дж.Р.Р.Толкина"**
=====================
Проект выполнен в рамках программы ДПО «Компьютерная лингвистика»
-----------------------------------
Данный проект представляет собой комплексное исследование текстовой структуры и системы персонажей легендарной трилогии Дж.Р.Р. Толкина. 

**Цель проекта** — извлечь скрытые темы и визуализировать социальную структуру произведения через анализ взаимодействий героев. 

**Задачи:**

* Сформировать корпус и провести глубокую предобработку текста.

* Выявить устойчивые тематические кластеры с помощью алгоритма LDA.

* Сравнить тематическую структуру трех книг («Хранители», «Две твердыни», «Возвращение государя»).

* Построить граф взаимодействий персонажей и рассчитать метрики их влияния на сюжет.

---
Код работает в Colab и доступен по ссылкам:

* [Часть 1. Предобработка и NER](https://drive.google.com/file/d/1yBFfVlweb6FaaCzvmQJYzhKE-1IHSjqT/view?usp=sharing)

* [Часть 2. Глобальное моделирование](https://drive.google.com/file/d/1NbqvBibyu2mGYoqMsqyLSZP7zg_zomL5/view?usp=sharing)

* [Часть 3. Локальное моделирование](https://drive.google.com/file/d/1Zqd1L0pSB2wcMttRDIl78d_-tle-qXal/view?usp=sharing)

* [Часть 4. Сетевой анализ](https://drive.google.com/file/d/1SJKvVxeqkqJX1NVGKD6N_bJaHvUA1ijN/view?usp=sharing)

---
#### Используемые технологии

* Язык: Python

* NLP и NER: Natasha (извлечение персонажей и локаций), PyMorphy3, NLTK.

* Тематическое моделирование: Gensim (LDA), pyLDAvis, Scikit-learn.

* Сетевой анализ: NetworkX, Itertools.

* Анализ и данные: Pandas, NumPy, Matplotlib, Seaborn, Pickle.

---
#### Структура проекта

1. `01_Text_Preprocessing_and_NER.ipynb`: Токенизация, удаление стоп-слов, лемматизация и выделение именованных сущностей (NER). Разбиение текста на сегменты (чанки) с перекрытием для сохранения контекста.

2. `02_Global_Topic_Modeling.ipynb`: Обучение глобальной модели LDA на всем корпусе трилогии. Определение оптимального количества тем и их интерпретация. Исследование «ролевого профиля» персонажей: сопоставление героев с тематическими кластерами и визуализация их участия в сюжете через тепловые карты.

3. `03_Local_Topic_Analysis.ipynb`: Построение локальных моделей для каждой книги и сопоставление их с глобальными темами.

4. `04_Network_Analysis.ipynb`: Построение социального графа персонажей на основе совместного упоминания. Расчет метрик популярности, посредничества и близости.

---
#### Методология

Тематическое моделирование (LDA)

* Обучение: Построена модель Латентного размещения Дирихле (Gensim LDA) для выявления скрытых тем.

* Анализ: Проведен на двух уровнях - глобальном (вся трилогия) и локальном (динамика по книгам).

* Интеграция сущностей: Разработан алгоритм сопоставления персонажей с доминирующими темами чанков. 

* Валидация: Расчет метрик когерентности и перплексии + оценка разделения тем (Topic Diversity) через визуализацию pyLDAvis.

Сетевой анализ персонажей (Social Network Analysis)

* Построение связей: Использован метод «скользящего окна» (50 слов) для фиксации взаимодействий персонажей.

* Метрики: Расчет Degree Centrality (популярность), Betweenness Centrality (связующая роль) и Closeness Centrality (близость к центру).

* Динамика: Сравнение изменения сетевой роли ключевых героев от первой к третьей книге.

---
### Основные результаты

Качество и валидация глобальной модели

* Метрика когерентности (Coherence Score: 0.53) и перплексия (-6.43) указывают на то, что модель успешно выделила интерпретируемые темы без «мусора».

* Показатель Topic Diversity: 0.66 и отсутствие фоновых слов подтверждают, что алгоритм четко разграничивает локации (Шир, Рохан, Мордор) и сюжетные линии.

* Энтропия распределения LDA (3.94) показывает значительно более выраженную структуру кластеризации по сравнению со случайным распределением.

Ролевые профили героев 

* Анализ подтвердил функциональное разделение ролей: Фродо и Сэм максимально сосредоточены в темах пути к Кольцу («Преследование Смеагола», «Бри», «Кирит Унгол»), в то время как Гэндальф и Арагорн равномерно распределены по ключевым военно-политическим сюжетам («Рохан», «Мория», «Совет»).

Качество и валидация локальных моделей

* Для каждого тома было подобрано индивидуальное количество тем (7 для «Хранителей», 6 для «Двух твердынь», 7 для «Возвращения государя»). Средний показатель когерентности ~0.49 подтверждает высокую содержательную плотность локальных кластеров.

Сетевой анализ

* Обладая умеренной популярностью (Degree=0.275), Саурон имеет наивысший показатель связующей роли (0.229) во всей трилогии. Это подтверждает его статус «незримого центра»: он почти не появляется лично, но именно через противодействие ему выстраиваются все социальные связи.

* Гэндальф остается самым популярным персонажем по количеству связей (Degree=0.644).

* Анализ «Двух твердынь» четко фиксирует разделение Братства. Лидером влияния становится Элронд (0.297), поскольку герои в разных частях Средиземья постоянно ссылаются на его решения и Совет. При этом Горлум (0.233) становится ключевым «мостом» для Фродо и Сэма.

