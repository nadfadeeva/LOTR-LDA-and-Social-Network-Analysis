**Учебный проект "Тематическое моделирование и сентимент-анализ трилогии «Властелин колец»"**
=====================
Проект выполнен в рамках программы ДПО «Компьютерная лингвистика»
-----------------------------------
Данный проект представляет собой комплексное исследование текстовой структуры и эмоционального фона легендарной трилогии Дж.Р.Р. Толкина. 

**Цель проекта** — извлечь скрытые темы и отследить эмоциональную траекторию сюжета. Проект разделен на четыре этапа: от глубокой предобработки текста до построения трансформерных моделей сентимент-анализа.

**Задачи:**

* Сформировать корпус и провести глубокую предобработку текста.

* Выявить устойчивые тематические кластеры с помощью алгоритма LDA.

* Сравнить тематическую структуру трех книг («Хранители», «Две твердыни», «Возвращение государя»).

* Построить график «эмоциональных качелей» сюжета и сопоставить его с ключевыми событиями.

---
Код работает в Colab и доступен по ссылкам:

* [Часть 1. Предобработка и NER](https://drive.google.com/file/d/1yBFfVlweb6FaaCzvmQJYzhKE-1IHSjqT/view?usp=sharing)

* [Часть 2. Глобальное моделирование](https://drive.google.com/file/d/1NbqvBibyu2mGYoqMsqyLSZP7zg_zomL5/view?usp=sharing)

* [Часть 3. Локальное моделирование](https://drive.google.com/file/d/1Zqd1L0pSB2wcMttRDIl78d_-tle-qXal/view?usp=sharing)

* [Часть 4. Сентимент-анализ](https://drive.google.com/file/d/1SJKvVxeqkqJX1NVGKD6N_bJaHvUA1ijN/view?usp=sharing)

---
#### Используемые технологии

* Язык: Python

* NLP и NER: Natasha (извлечение персонажей и локаций), PyMorphy3, NLTK.

* Тематическое моделирование: Gensim (LDA), pyLDAvis, Scikit-learn.

* Deep Learning и сентимент: Transformers (BERT-based модели), SciPy.

* Анализ и данные: Pandas, NumPy, Matplotlib, Seaborn, tqdm, Pickle.

---
#### Структура проекта

1. `01_Text_Preprocessing_and_NER.ipynb`: Токенизация, удаление стоп-слов, лемматизация и выделение именованных сущностей (NER). Разбиение текста на сегменты (чанки) с перекрытием для сохранения контекста.

2. `02_Global_Topic_Modeling.ipynb`: Обучение глобальной модели LDA на всем корпусе трилогии. Определение оптимального количества тем и их интерпретация.

3. `03_Local_Topic_Analysis.ipynb`: Построение локальных моделей для каждой книги.

4. `04_Sentiment_Analysis_Transformer.ipynb`: Глубокий анализ эмоциональной окраски с использованием предобученных трансформеров. Построение графиков «эмоциональных качелей» произведения.

---
#### Методология

Тематическое моделирование (LDA)

* Обучение: Построена модель Латентного размещения Дирихле (Gensim LDA) для выявления скрытых тем.

* Анализ: Проведен на двух уровнях — глобальном (вся трилогия) и локальном (динамика по книгам).

* Валидация: Расчет метрик когерентности и перплексии + оценка разделения тем (Topic Diversity) через визуализацию pyLDAvis.

Сентимент-анализ и сглаживание

* Sentiment Pipeline: Использованы предобученные трансформерные модели для классификации эмоциональной окраски каждого фрагмента.

* Сглаживание: Для устранения локальных «шумов» и выявления глобальной эмоциональной арки сюжета применено гауссово сглаживание.

---
### Основные результаты

Качество и валидация глобальной модели

* Метрика когерентности (Coherence Score: 0.53) и перплексия (-6.43) указывают на то, что модель успешно выделила интерпретируемые темы без «мусора».

* Показатель Topic Diversity: 0.66 и отсутствие фоновых слов подтверждают, что алгоритм четко разграничивает локации (Шир, Рохан, Мордор) и сюжетные линии.

* Энтропия распределения LDA (3.94) показывает значительно более выраженную структуру кластеризации по сравнению со случайным распределением.

Качество и валидация локальных моделей

* Для каждого тома было подобрано индивидуальное количество тем (7 для «Хранителей», 6 для «Двух твердынь», 7 для «Возвращения государя»). Средний показатель когерентности ~0.49 подтверждает высокую содержательную плотность локальных кластеров.

Эмоциональный профиль

Анализ тональности выявил глобальный нисходящий тренд (погружение во тьму):

* Книга 1: +0.018 (Надежда, начало пути, уютные локации).

* Книга 2: -0.042 (Нарастание тревоги, разделение героев).

* Книга 3: -0.070 (Кульминация отчаяния, война).

